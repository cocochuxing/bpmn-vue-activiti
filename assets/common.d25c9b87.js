var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,i=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,a=(e,a)=>{for(var o in a||(a={}))t.call(a,o)&&i(e,o,a[o]);if(l)for(var o of l(a))n.call(a,o)&&i(e,o,a[o]);return e};import{d as o,r as s,a as r,o as d,w as u,c as p,X as m,m as c,h as v,t as b,U as f,b as y,y as g,e as x,f as I,G as V,i as O,B as E}from"./index.26fee642.js";const S=e=>JSON.parse(JSON.stringify(e));var h=o({props:{modelValue:{type:Array,default:()=>[],required:!0},columns:{type:Array,required:!0},model:{type:Object,default:()=>Object.assign({})},rules:{type:Object,default:()=>null},tableProps:{type:Object,default:()=>({stripe:!0,border:!0,size:"small","empty-text":"没有数据"})},addTitle:{type:String,default:()=>"+ 添加"}},emits:["update:modelValue"],setup(e,t){const l=s({data:e.modelValue?JSON.parse(JSON.stringify(e.modelValue)):[],editing:!1,editItem:{},editIndex:void 0,isNew:!1,sublistForm:null}),n=r();d((()=>{l.sublistForm=n.value}));u((()=>e.modelValue),(()=>{l.data=e.modelValue?JSON.parse(JSON.stringify(e.modelValue)):[],l.editing=!1,l.editItem=void 0,l.editIndex=void 0,l.isNew=!1}));const i=j(l,t);return{sublistState:l,addData:()=>{l.data.push(S(e.model)),l.editIndex=l.data.length-1,l.editing=!0,l.editItem=S(S(e.model)),l.isNew=!0},form:n,actionColumnProps:i}},render(){const e=this.$props,t=this.sublistState,l=S(e.tableProps),n={size:"mini",inline:!0,"inline-message":!0,"show-message":!0,rules:e.rules,model:t.editItem};return p("div",{class:"sublist-div"},[t.data?p(m,c({ref:"form"},n),{default:()=>[p(v,c(l,{data:t.data}),{default:()=>[e.columns.map((e=>{const l=b(e);if(t.editing&&"index"!==l.type){const e=l.editComponent||function(e,t){return p(f,{size:"mini",class:"sublist-form-item",label:e.column.name,prop:e.column.property},{default:()=>[p(y,{label:e.column.label,size:"mini",modelValue:t.editItem[e.column.property],"onUpdate:modelValue":l=>t.editItem[e.column.property]=l},null)]})};return p(g,l,a({},{default:l=>{const n=l.row[l.column.property];return t.editIndex===l.$index?e(l,t):l.column.formatter?l.column.formatter(l.row,l.column,n,l.$index):n}}))}return p(g,l,null)})),p(g,this.actionColumnProps,a({},this.actionColumnProps.vSlots))]})]}):"",t.editing?"":p("div",{class:"sublist-add",onClick:()=>this.addData()},[e.addTitle])])}});const j=(e,t)=>({align:"center",label:"操作",vSlots:{default:l=>p("div",{class:"sublist-actions"},[e.editing&&l.$index===e.editIndex?p("div",null,[p("span",{class:"sublist-confirm sublist-btn",onClick:()=>{e.sublistForm.validate((l=>{if(!l)return!1;"number"==typeof(null==e?void 0:e.editIndex)&&e.data.splice(null==e?void 0:e.editIndex,1,S(b(e.editItem))),e.editIndex=void 0,e.editItem=void 0,e.editing=!1,t.emit("update:modelValue",e.data)}))}},[x("确认")]),p("span",{class:"sublist-split"},[x("|")]),p("span",{class:"sublist-cancel sublist-btn",onClick:()=>(e.isNew&&e.data.splice(e.data.length-1,1),e.editItem=void 0,e.editing=!1,void(e.editIndex=void 0))},[x("取消")])]):p("div",null,[p("span",{class:(e.editing?"readonly":"")+" sublist-edit sublist-btn",onClick:()=>{e.editing||function(t){e.editIndex=t.$index,e.editing=!0,e.editItem=S(t.row)}(l)}},[x("编辑")]),p("span",{class:(e.editing?"readonly":"")+" "},[x("|")]),p("span",{class:(e.editing?"readonly":"")+" sublist-delete sublist-btn",onClick:()=>{var n,i;e.editing||(n=l.$index,null==(i=null==e?void 0:e.data)||i.splice(n,1),t.emit("update:modelValue",e.data))}},[x("删除")])])])}});function w(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!O(e)}const C={name:"基础信息",icon:"el-icon-info",properties:a({},{id:{component:y,placeholder:"节点ID",vSlots:{prepend:()=>p("div",null,[x("节点ID")])}},name:{component:y,placeholder:"节点名称",vSlots:{prepend:()=>p("div",null,[x("节点名称")])}}})},P={name:"元素文档",icon:"el-icon-document",properties:{"documentation.text":{component:y,type:"textarea",getValue:e=>{var t,l;return null==(l=null==(t=e.documentation)?void 0:t[0])?void 0:l.text},setValue(e,t,l){E.createElement("bpmn:Documentation","documentation",{text:l},!0)}}}},N={name:"表单信息",icon:"el-icon-edit",properties:{formKey:{component:y,placeholder:"表单key",vSlots:{prepend:()=>p("div",null,[x("表单key")])}}}},k=[{label:"开始",value:"start"},{label:"结束",value:"end"}],$=[{label:"java类",value:"class"},{label:"调用表达式",value:"expression"},{label:"注入表达式",value:"delegateExpression"}],q=function(e){const t=e.eventOptions||k;return{name:e.name||"监听器",icon:e.icon||"el-icon-bell",properties:{"extensionElements.listeners":{component:h,columns:[{type:"index",label:"序号",align:"center"},{prop:"event",label:"事件",align:"center",formatter:(e,l)=>t.filter((t=>t.value===e[l.property]))[0].label,editComponent:function(e,l){let n;return p(f,{size:"mini",class:"sublist-form-item",label:e.column.name,prop:e.column.property},{default:()=>[p(I,{modelValue:l.editItem.event,"onUpdate:modelValue":e=>l.editItem.event=e},w(n=t.map((e=>p(V,{key:e.value,label:e.label,value:e.value},null))))?n:{default:()=>[n]})]})}},{prop:"type",label:"执行类型",align:"center",formatter:(e,t)=>$.filter((l=>l.value===e[t.property]))[0].label,editComponent:function(e,t){let l;return p(f,{size:"mini",class:"sublist-form-item",label:e.column.name,prop:e.column.property},{default:()=>[p(I,{modelValue:t.editItem.type,"onUpdate:modelValue":e=>t.editItem.type=e},w(l=$.map((e=>p(V,{key:e.value,label:e.label,value:e.value},null))))?l:{default:()=>[l]})]})}},{prop:"content",label:"执行内容",align:"center"}],rules:{event:[{required:!0,message:"事件不能为空"}],type:[{required:!0,message:"类型不能为空"}],content:[{required:!0,message:"执行内容不能为空"}]},getValue:e=>{var t,l,n;return null==(n=null==(l=null==(t=null==e?void 0:e.extensionElements)?void 0:t.values)?void 0:l.filter((e=>"activiti:ExecutionListener"===e.$type)))?void 0:n.map((e=>{const t=e.expression?"expression":e.delegateExpression?"delegateExpression":"class";return{event:e.event,type:t,content:e[t]}}))},setValue(e,t,l){const n=E,i=n.getModeler().get("moddle");n.updateExtensionElements("activiti:ExecutionListener",l.map((e=>i.create("activiti:ExecutionListener",{event:e.event,[e.type]:e.content}))))}}}}},z={name:"扩展属性",icon:"el-icon-document-add",properties:{"extensionElements.properties":{component:h,columns:[{type:"index",label:"序号",align:"center"},{prop:"name",label:"属性名",align:"center"},{prop:"value",label:"属性值",align:"center"}],rules:{name:[{required:!0,message:"属性名不能为空"}],value:[{required:!0,message:"属性值不能为空"}]},getValue:e=>{var t,l,n;return null==(n=null==(l=null==(t=null==e?void 0:e.extensionElements)?void 0:t.values)?void 0:l.filter((e=>"activiti:Properties"===e.$type))[0])?void 0:n.values.map((e=>({name:e.name,value:e.value})))},setValue(e,t,l){const n=E,i=n.getModeler().get("moddle"),a=i.create("activiti:Properties",{values:l.map((e=>i.create("activiti:Property",{name:e.name,value:e.value})))});n.updateExtensionElements("activiti:Properties",a)}}}};export{C,P as D,z as E,N as F,q as g};
